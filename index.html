<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROBOT INTERFACE (Web Mock)</title>
    <link rel="stylesheet" href="style.css">
</head>
<style>
    
</style>
<body>
    <div class="background-overlay"></div>

    <div class="content-wrapper">

        <div class="main-grid-container">
            <button class="ctk-button" data-action="follow-me">Follow Me</button>
            <button class="ctk-button" data-action="voice">Voice</button>
            <button class="ctk-button" data-action="tracking">Object Tracking</button>
            <button class="ctk-button" data-action="touch-control">Touch Control</button>
        </div>

        <div class="bottom-bar-container">
            <div class="bottom-frame">
                <button class="ctk-button speak-toggle" 
                        data-text="Welcome to Francis Xavier Engineering College. I am thrilled to welcome you to our 25th Annual Day celebration, our Silver Jubilee Year!"
                        data-original-text="Intro"
                        data-speaking="false">
                    Intro
                </button>
                
                <button class="ctk-button exit-button" data-action="exit">Exit</button>
        
                <button class="ctk-button speak-toggle" 
                        data-text="Follow me. I'll lead you to the refreshment area."
                        data-original-text="Refreshment"
                        data-speaking="false">
                    Refreshment
                </button>
                <button class="ctk-button fullscreen-toggle" data-action="fullscreen">Full Screen</button>
            </div>
        </div>

    </div>


<script>
document.addEventListener('DOMContentLoaded', () => {
Â  Â  const allButtons = document.querySelectorAll('.ctk-button');
Â  Â  const speakButtons = document.querySelectorAll('.speak-toggle');
Â  Â  const fullscreenButton = document.querySelector('.fullscreen-toggle');
Â  Â  let currentUtterance = null;

Â  Â  const API_URL = "http://127.0.0.1:5000/api/command";

Â  Â  // Reset all speaking buttons
Â  Â  const resetAllSpeakButtons = () => {
Â  Â  Â  Â  speakButtons.forEach(btn => {
Â  Â  Â  Â  Â  Â  btn.textContent = btn.getAttribute('data-original-text');
Â  Â  Â  Â  Â  Â  btn.classList.remove('speaking');
Â  Â  Â  Â  Â  Â  btn.setAttribute('data-speaking', 'false');
Â  Â  Â  Â  });
Â  Â  Â  Â  currentUtterance = null;
Â  Â  };

Â  Â  // Speech function
Â  Â  function speakText(text, onEndCallback) {
Â  Â  Â  Â  if ('speechSynthesis' in window) {
Â  Â  Â  Â  Â  Â  window.speechSynthesis.cancel();
Â  Â  Â  Â  Â  Â  const utterance = new SpeechSynthesisUtterance(text);
Â  Â  Â  Â  Â  Â  utterance.rate = 1.0;
Â  Â  Â  Â  Â  Â  utterance.volume = 1.0;

Â  Â  Â  Â  Â  Â  const voices = window.speechSynthesis.getVoices();
Â  Â  Â  Â  Â  Â  const femaleVoice = voices.find(voice =>
Â  Â  Â  Â  Â  Â  Â  Â  voice.name.toLowerCase().includes('female') ||
Â  Â  Â  Â  Â  Â  Â  Â  voice.name.toLowerCase().includes('zira')
Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  if (femaleVoice) utterance.voice = femaleVoice;

Â  Â  Â  Â  Â  Â  utterance.onend = onEndCallback;
Â  Â  Â  Â  Â  Â  window.speechSynthesis.speak(utterance);
Â  Â  Â  Â  Â  Â  return utterance;
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  alert("Speaking: " + text);
Â  Â  Â  Â  Â  Â  setTimeout(onEndCallback, 2000);
Â  Â  Â  Â  Â  Â  return null;
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // --- Send command to Flask API ---
Â  Â  async function sendCommandToAPI(command) {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  const response = await fetch(API_URL, {
Â  Â  Â  Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/json" },
Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ command })
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  const result = await response.json();
Â  Â  Â  Â  Â  Â  console.log("ðŸ”— API Response:", result);

Â  Â  Â  Â  Â  Â  if (result.status === "success") {
Â  Â  Â  Â  Â  Â  Â  Â  alert("âœ… " + result.message);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  alert("âš ï¸ " + result.message);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  console.error("âŒ API Error:", err);
Â  Â  Â  Â  Â  Â  alert("âš ï¸ Failed to reach Flask API. Make sure it's running.");
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // --- Fullscreen Toggle Function ---
Â  Â  const toggleFullscreen = () => {
Â  Â  Â  Â  if (!document.fullscreenElement) {
Â  Â  Â  Â  Â  Â  document.documentElement.requestFullscreen().then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  fullscreenButton.textContent = "Exit Fullscreen";
Â  Â  Â  Â  Â  Â  }).catch(err => {
Â  Â  Â  Â  Â  Â  Â  Â  console.error(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
Â  Â  Â  Â  Â  Â  Â  Â  alert("âš ï¸ Fullscreen mode failed. The browser may not support it.");
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  document.exitFullscreen().then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  fullscreenButton.textContent = "Full Screen";
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  };

Â  Â  // --- General Button Click Handlers ---
Â  Â  allButtons.forEach(button => {
Â  Â  Â  Â  button.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  if (button.classList.contains('speak-toggle')) return;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const action = button.getAttribute('data-action');
Â  Â  Â  Â  Â  Â  console.log(`Action: ${action} triggered!`);

Â  Â  Â  Â  Â  Â  switch (action) {
Â  Â  Â  Â  Â  Â  Â  Â  case 'follow-me':
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sendCommandToAPI("follow_me");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  Â  Â  case 'voice':
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  window.location.href = 'chat.html';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  Â  Â  case 'tracking':
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Starting 'Object Tracking'...");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  Â  Â  case 'touch-control':
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  window.location.href = 'touch_pad.html';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  Â  Â  case 'exit':
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Exiting application. Goodbye!");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  Â  Â  case 'fullscreen':
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  toggleFullscreen();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  });
Â  Â  
Â  Â  // --- Speech Toggle Logic ---
Â  Â  speakButtons.forEach(button => {
Â  Â  Â  Â  button.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  const isCurrentlySpeaking = button.getAttribute('data-speaking') === 'true';
Â  Â  Â  Â  Â  Â  if (isCurrentlySpeaking) {
Â  Â  Â  Â  Â  Â  Â  Â  window.speechSynthesis.cancel();
Â  Â  Â  Â  Â  Â  Â  Â  resetAllSpeakButtons();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  resetAllSpeakButtons();
Â  Â  Â  Â  Â  Â  Â  Â  button.textContent = "Stop";
Â  Â  Â  Â  Â  Â  Â  Â  button.classList.add('speaking');
Â  Â  Â  Â  Â  Â  Â  Â  button.setAttribute('data-speaking', 'true');
Â  Â  Â  Â  Â  Â  Â  Â  const speechText = button.getAttribute('data-text');
Â  Â  Â  Â  Â  Â  Â  Â  currentUtterance = speakText(speechText, resetAllSpeakButtons);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  });

Â  Â  window.addEventListener('beforeunload', () => {
Â  Â  Â  Â  if ('speechSynthesis' in window) window.speechSynthesis.cancel();
Â  Â  });
});
</script>

</body>
</html>